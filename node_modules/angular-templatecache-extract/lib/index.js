"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _esquery = _interopRequireDefault(require("esquery"));

var _espree = _interopRequireDefault(require("espree"));

var _bluebird = _interopRequireDefault(require("bluebird"));

var _staticEval = _interopRequireDefault(require("static-eval"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function angularTemplatecacheExtract(js) {
  return new _bluebird.default(function (resolve) {
    var result = [];

    var content = _espree.default.parse(js);

    var tree = (0, _esquery.default)(content, 'CallExpression[callee.object.name="$templateCache"]' + '[callee.object.type="Identifier"]' + '[callee.property.name="put"]' + '[callee.property.type="Identifier"]');

    _bluebird.default.map(tree, function (elem) {
      if (elem.arguments && elem.arguments[1]) {
        var ev = (0, _staticEval.default)(elem.arguments[1]);

        if (ev) {
          result.push(ev);
        }
      }

      return _bluebird.default.resolve();
    }).then(function () {
      resolve(result);
    });
  });
}

var _default = angularTemplatecacheExtract;
exports.default = _default;
module.exports = exports.default;